<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Practical Solutions</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            margin: 0;
            font-size: 2.5em;
            text-align: center;
        }

        .subtitle {
            text-align: center;
            margin-top: 10px;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 24px;
            background: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            color: #555;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .tab.active {
            background: #667eea;
            color: white;
        }

        .content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .content.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h2 {
            color: #667eea;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
            margin-top: 0;
        }

        h3 {
            color: #764ba2;
            margin-top: 25px;
        }

        .question {
            background: #f8f9fa;
            padding: 15px;
            border-left: 4px solid #667eea;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }

        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
        }

        code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
        }

        .note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }

        .solution {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        th {
            background: #667eea;
            color: white;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        .copy-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 0;
            float: right;
            transition: background 0.3s;
        }

        .copy-btn:hover {
            background: #218838;
        }

        .index {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .index-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #764ba2;
        }

        .index-num {
            display: inline-block;
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            text-align: center;
            line-height: 30px;
            border-radius: 50%;
            margin-right: 10px;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            color: #666;
            padding: 20px;
            border-top: 1px solid #ddd;
        }
    </style>
</head>

<body>
    <a href="index.html">web design ->>>>></a>
    <br><br>
    <a href="data-structure.html">Data Structure ->>>>></a>
    <br><br>
    <div class="header">
        <h1>Python Practical Solutions</h1>
        <div class="subtitle">Complete solutions for SQLite3, CSV/Excel operations, and Data Analysis</div>
    </div>

    <div class="tabs">
        <button class="tab active" onclick="showTab('practical1')">Practical 1 - SQLite3</button>
        <button class="tab" onclick="showTab('practical23')">Practical 2 & 3</button>
        <button class="tab" onclick="showTab('practical45')">Practical 4 & 5</button>
    </div>

    <!-- Practical 1 Content -->
    <div id="practical1" class="content active">
        <h2>Practical 1: SQLite3 Database Operations</h2>

        <div class="question">
            <h3>1. Create employee table in sqlite3 with proper validation</h3>
            <button class="copy-btn" onclick="copyCode('code1')">Copy Code</button>
            <pre id="code1">import sqlite3

# Connect to database (creates if doesn't exist)
conn = sqlite3.connect('company.db')
cursor = conn.cursor()

# Create employee table with validations
cursor.execute('''
CREATE TABLE IF NOT EXISTS employees (
    e_id INTEGER PRIMARY KEY AUTOINCREMENT,
    e_name TEXT NOT NULL,
    e_city TEXT NOT NULL,
    e_mobno TEXT UNIQUE CHECK(length(e_mobno) = 10),
    e_email TEXT UNIQUE CHECK(e_email LIKE '%@%'),
    e_age INTEGER CHECK(e_age >= 18 AND e_age <= 65),
    e_salary REAL CHECK(e_salary >= 10000)
)
''')

# Insert sample data
employees_data = [
    ('John Doe', 'New York', '1234567890', 'john@email.com', 25, 75000),
    ('Jane Smith', 'London', '0987654321', 'jane@email.com', 30, 85000),
    ('Bob Wilson', 'Paris', '1122334455', 'bob@email.com', 22, 65000),
    ('Alice Brown', 'Tokyo', '2233445566', 'alice@email.com', 28, 95000),
    ('Charlie Davis', 'Berlin', '3344556677', 'charlie@email.com', 35, 55000),
    ('Diana Miller', 'Mumbai', '4455667788', 'diana@email.com', 24, 72000),
    ('Ethan Wilson', 'Delhi', '5566778899', 'ethan@email.com', 29, 88000),
    ('Fiona Garcia', 'Sydney', '6677889900', 'fiona@email.com', 31, 92000)
]

cursor.executemany('''
INSERT OR IGNORE INTO employees (e_name, e_city, e_mobno, e_email, e_age, e_salary)
VALUES (?, ?, ?, ?, ?, ?)
''', employees_data)

conn.commit()
print("Employee table created successfully!")
print("Total rows inserted:", cursor.rowcount)

# Display all records
cursor.execute("SELECT * FROM employees")
rows = cursor.fetchall()

print("\nAll Employee Records:")
print("-" * 80)
print(f"{'ID':<5} {'Name':<15} {'City':<10} {'Mobile':<12} {'Email':<20} {'Age':<5} {'Salary':<10}")
print("-" * 80)
for row in rows:
    print(f"{row[0]:<5} {row[1]:<15} {row[2]:<10} {row[3]:<12} {row[4]:<20} {row[5]:<5} {row[6]:<10}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>2. Display only unique names of employees</h3>
            <button class="copy-btn" onclick="copyCode('code2')">Copy Code</button>
            <pre id="code2">import sqlite3

conn = sqlite3.connect('company.db')
cursor = conn.cursor()

# Display unique names
cursor.execute("SELECT DISTINCT e_name FROM employees")
unique_names = cursor.fetchall()

print("Unique Employee Names:")
print("-" * 30)
for name in unique_names:
    print(name[0])

conn.close()</pre>
        </div>

        <div class="question">
            <h3>3. Display employees whose age is 20 or 30</h3>
            <button class="copy-btn" onclick="copyCode('code3')">Copy Code</button>
            <pre id="code3">import sqlite3

conn = sqlite3.connect('company.db')
cursor = conn.cursor()

# Employees with age 20 or 30
cursor.execute("SELECT * FROM employees WHERE e_age IN (20, 30)")
employees = cursor.fetchall()

print("Employees with age 20 or 30:")
print("-" * 80)
for emp in employees:
    print(f"ID: {emp[0]}, Name: {emp[1]}, Age: {emp[5]}, City: {emp[2]}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>4. Employees with salary between 60,000 and 90,000</h3>
            <button class="copy-btn" onclick="copyCode('code4')">Copy Code</button>
            <pre id="code4">import sqlite3

conn = sqlite3.connect('company.db')
cursor = conn.cursor()

cursor.execute("SELECT * FROM employees WHERE e_salary BETWEEN 60000 AND 90000")
employees = cursor.fetchall()

print("Employees with salary between 60,000 to 90,000:")
print("-" * 80)
for emp in employees:
    print(f"Name: {emp[1]:<15} Salary: {emp[6]:<10} City: {emp[2]}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>5. Employees with age between 20-25</h3>
            <button class="copy-btn" onclick="copyCode('code5')">Copy Code</button>
            <pre id="code5">import sqlite3

conn = sqlite3.connect('company.db')
cursor = conn.cursor()

cursor.execute("SELECT * FROM employees WHERE e_age BETWEEN 20 AND 25")
employees = cursor.fetchall()

print("Employees with age between 20-25:")
print("-" * 80)
for emp in employees:
    print(f"ID: {emp[0]:<3} Name: {emp[1]:<15} Age: {emp[5]:<3} Salary: {emp[6]}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>6. Employees with age NOT between 20-25</h3>
            <button class="copy-btn" onclick="copyCode('code6')">Copy Code</button>
            <pre id="code6">import sqlite3

conn = sqlite3.connect('company.db')
cursor = conn.cursor()

cursor.execute("SELECT * FROM employees WHERE e_age NOT BETWEEN 20 AND 25")
employees = cursor.fetchall()

print("Employees with age NOT between 20-25:")
print("-" * 80)
for emp in employees:
    print(f"ID: {emp[0]:<3} Name: {emp[1]:<15} Age: {emp[5]:<3} Salary: {emp[6]}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>7. Search for specific name pattern</h3>
            <button class="copy-btn" onclick="copyCode('code7')">Copy Code</button>
            <pre id="code7">import sqlite3

conn = sqlite3.connect('company.db')
cursor = conn.cursor()

# Search for names starting with 'J'
cursor.execute("SELECT * FROM employees WHERE e_name LIKE 'J%'")
employees = cursor.fetchall()

print("Employees with names starting with 'J':")
print("-" * 80)
for emp in employees:
    print(f"Name: {emp[1]}, Email: {emp[4]}")

print("\n" + "="*80)

# Search for names containing 'son'
cursor.execute("SELECT * FROM employees WHERE e_name LIKE '%son%'")
employees = cursor.fetchall()

print("Employees with names containing 'son':")
print("-" * 80)
for emp in employees:
    print(f"Name: {emp[1]}, City: {emp[2]}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>8. Create worker and workers1 tables</h3>
            <button class="copy-btn" onclick="copyCode('code8')">Copy Code</button>
            <pre id="code8">import sqlite3

conn = sqlite3.connect('workers.db')
cursor = conn.cursor()

# Create worker table
cursor.execute('''
CREATE TABLE IF NOT EXISTS worker (
    worker_id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    department TEXT CHECK(department IN ('IT', 'HR', 'Finance', 'Sales')),
    salary REAL DEFAULT 25000,
    join_date DATE DEFAULT CURRENT_DATE
)
''')

# Create workers1 table
cursor.execute('''
CREATE TABLE IF NOT EXISTS workers1 (
    worker_id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    position TEXT,
    experience_years INTEGER CHECK(experience_years >= 0)
)
''')

# Insert sample data into worker
worker_data = [
    ('Raj Patel', 'IT', 45000),
    ('Priya Sharma', 'HR', 35000),
    ('Amit Kumar', 'Finance', 55000),
    ('Neha Singh', 'Sales', 40000),
    ('Vikram Mehta', 'IT', 50000),
    ('Raj Patel', 'IT', 45000),  # Duplicate name
    ('Sonia Gupta', 'HR', 38000)
]

cursor.executemany('''
INSERT INTO worker (name, department, salary) VALUES (?, ?, ?)
''', worker_data)

# Insert sample data into workers1
workers1_data = [
    ('Raj Patel', 'Developer', 3),
    ('Priya Sharma', 'Manager', 5),
    ('Amit Kumar', 'Analyst', 2),
    ('Deepak Verma', 'Designer', 4),
    ('Anjali Rao', 'Tester', 1)
]

cursor.executemany('''
INSERT INTO workers1 (name, position, experience_years) VALUES (?, ?, ?)
''', workers1_data)

conn.commit()
print("Worker and workers1 tables created successfully!")
print("Records inserted into worker table:", cursor.rowcount)

conn.close()</pre>
        </div>

        <div class="question">
            <h3>9. Display data common in both tables (INTERSECT)</h3>
            <button class="copy-btn" onclick="copyCode('code9')">Copy Code</button>
            <pre id="code9">import sqlite3

conn = sqlite3.connect('workers.db')
cursor = conn.cursor()

print("Common data in both tables (names that appear in both):")
print("-" * 50)

# Using INTERSECT
cursor.execute('''
SELECT name FROM worker
INTERSECT
SELECT name FROM workers1
''')
common_names = cursor.fetchall()

print("Names appearing in both tables:")
for name in common_names:
    print(f"• {name[0]}")

print("\nFull details of common workers:")
cursor.execute('''
SELECT w.* FROM worker w
JOIN workers1 w1 ON w.name = w1.name
''')
common_workers = cursor.fetchall()

for worker in common_workers:
    print(f"ID: {worker[0]}, Name: {worker[1]}, Dept: {worker[2]}, Salary: {worker[3]}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>10. Display data NOT in workers1 table</h3>
            <button class="copy-btn" onclick="copyCode('code10')">Copy Code</button>
            <pre id="code10">import sqlite3

conn = sqlite3.connect('workers.db')
cursor = conn.cursor()

print("Data in worker table NOT in workers1 table:")
print("-" * 60)

# Using EXCEPT
cursor.execute('''
SELECT name FROM worker
EXCEPT
SELECT name FROM workers1
''')
unique_to_worker = cursor.fetchall()

print("Names in worker table but NOT in workers1:")
for name in unique_to_worker:
    print(f"• {name[0]}")

print("\nFull details of workers not in workers1 table:")
cursor.execute('''
SELECT w.* FROM worker w
LEFT JOIN workers1 w1 ON w.name = w1.name
WHERE w1.name IS NULL
''')
unique_workers = cursor.fetchall()

for worker in unique_workers:
    print(f"ID: {worker[0]}, Name: {worker[1]}, Dept: {worker[2]}, Salary: {worker[3]}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>11. Display first 5 records from worker table</h3>
            <button class="copy-btn" onclick="copyCode('code11')">Copy Code</button>
            <pre id="code11">import sqlite3

conn = sqlite3.connect('workers.db')
cursor = conn.cursor()

# First 5 records
cursor.execute("SELECT * FROM worker LIMIT 5")
first_five = cursor.fetchall()

print("First 5 records from worker table:")
print("-" * 80)
print(f"{'ID':<5} {'Name':<15} {'Department':<10} {'Salary':<10} {'Join Date':<12}")
print("-" * 80)
for worker in first_five:
    print(f"{worker[0]:<5} {worker[1]:<15} {worker[2]:<10} {worker[3]:<10} {worker[4] if worker[4] else 'N/A':<12}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>12. Group by name and display sum of salary</h3>
            <button class="copy-btn" onclick="copyCode('code12')">Copy Code</button>
            <pre id="code12">import sqlite3

conn = sqlite3.connect('workers.db')
cursor = conn.cursor()

# Group by name and sum salary
cursor.execute('''
SELECT name, SUM(salary) as total_salary, COUNT(*) as count
FROM worker
GROUP BY name
HAVING COUNT(*) > 0
ORDER BY total_salary DESC
''')
grouped_data = cursor.fetchall()

print("Grouped by Name - Total Salary:")
print("-" * 50)
print(f"{'Name':<15} {'Total Salary':<15} {'Count':<10}")
print("-" * 50)
for data in grouped_data:
    print(f"{data[0]:<15} {data[1]:<15} {data[2]:<10}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>13. Different types of joins</h3>
            <button class="copy-btn" onclick="copyCode('code13')">Copy Code</button>
            <pre id="code13">import sqlite3

conn = sqlite3.connect('workers.db')
cursor = conn.cursor()

print("="*80)
print("INNER JOIN (common records):")
print("-" * 80)
cursor.execute('''
SELECT w.name, w.department, w1.position, w.salary
FROM worker w
INNER JOIN workers1 w1 ON w.name = w1.name
''')
inner_join = cursor.fetchall()
for row in inner_join:
    print(f"Name: {row[0]:<15} Dept: {row[1]:<10} Position: {row[2]:<15} Salary: {row[3]}")

print("\n" + "="*80)
print("LEFT JOIN (all from worker + matching from workers1):")
print("-" * 80)
cursor.execute('''
SELECT w.name, w.department, w1.position, w.salary
FROM worker w
LEFT JOIN workers1 w1 ON w.name = w1.name
''')
left_join = cursor.fetchall()
for row in left_join:
    position = row[2] if row[2] else 'N/A'
    print(f"Name: {row[0]:<15} Dept: {row[1]:<10} Position: {position:<15} Salary: {row[3]}")

print("\n" + "="*80)
print("FULL OUTER JOIN (all from both tables):")
print("-" * 80)
cursor.execute('''
SELECT w.name, w.department, w1.position
FROM worker w
LEFT JOIN workers1 w1 ON w.name = w1.name
UNION
SELECT w1.name, 'N/A', w1.position
FROM workers1 w1
LEFT JOIN worker w ON w1.name = w.name
WHERE w.name IS NULL
''')
full_join = cursor.fetchall()
for row in full_join:
    print(f"Name: {row[0]:<15} Dept/Status: {row[1]:<10} Position: {row[2]}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>14. Create trigger on name column</h3>
            <button class="copy-btn" onclick="copyCode('code14')">Copy Code</button>
            <pre id="code14">import sqlite3

conn = sqlite3.connect('trigger_example.db')
cursor = conn.cursor()

# Create emp1 table
cursor.execute('''
CREATE TABLE IF NOT EXISTS emp1 (
    emp_id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    department TEXT,
    salary REAL
)
''')

# Create trigger that logs name changes
cursor.execute('''
CREATE TABLE IF NOT EXISTS name_change_log (
    log_id INTEGER PRIMARY KEY AUTOINCREMENT,
    emp_id INTEGER,
    old_name TEXT,
    new_name TEXT,
    change_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
)
''')

# Create trigger on emp1 table
cursor.execute('''
CREATE TRIGGER IF NOT EXISTS log_name_change
AFTER UPDATE OF name ON emp1
FOR EACH ROW
BEGIN
    INSERT INTO name_change_log (emp_id, old_name, new_name)
    VALUES (OLD.emp_id, OLD.name, NEW.name);
END;
''')

# Insert sample data
cursor.execute("INSERT INTO emp1 (name, department, salary) VALUES ('Rahul Sharma', 'IT', 50000)")
cursor.execute("INSERT INTO emp1 (name, department, salary) VALUES ('Priya Verma', 'HR', 45000)")

conn.commit()
print("emp1 table and trigger created successfully!")

# Test the trigger
print("\nBefore update:")
cursor.execute("SELECT * FROM emp1")
for row in cursor.fetchall():
    print(f"ID: {row[0]}, Name: {row[1]}, Dept: {row[2]}, Salary: {row[3]}")

# Update a name (trigger will fire)
cursor.execute("UPDATE emp1 SET name = 'Rahul Kumar' WHERE name = 'Rahul Sharma'")
conn.commit()

print("\nAfter update:")
cursor.execute("SELECT * FROM emp1")
for row in cursor.fetchall():
    print(f"ID: {row[0]}, Name: {row[1]}, Dept: {row[2]}, Salary: {row[3]}")

print("\nName change log:")
cursor.execute("SELECT * FROM name_change_log")
logs = cursor.fetchall()
if logs:
    for log in logs:
        print(f"Log ID: {log[0]}, Emp ID: {log[1]}, Old: {log[2]}, New: {log[3]}, Date: {log[4]}")
else:
    print("No name changes logged.")

conn.close()</pre>
        </div>
    </div>

    <!-- Practical 2 & 3 Content -->
    <div id="practical23" class="content">
        <h2>Practical 2 & 3: CSV Operations and Database Integration</h2>

        <div class="question">
            <h3>1. Create students table and insert data</h3>
            <button class="copy-btn" onclick="copyCode('code15')">Copy Code</button>
            <pre id="code15">import sqlite3
import random

conn = sqlite3.connect('students.db')
cursor = conn.cursor()

# Create students table
cursor.execute('''
CREATE TABLE IF NOT EXISTS students (
    s_id INTEGER PRIMARY KEY AUTOINCREMENT,
    s_name TEXT NOT NULL,
    s_city TEXT NOT NULL,
    s_gender TEXT CHECK(s_gender IN ('Male', 'Female', 'Other'))
)
''')

# Sample data
cities = ['Surat', 'Mumbai', 'Delhi', 'Bangalore', 'Chennai', 'Kolkata', 'Hyderabad']
names_male = ['Raj', 'Amit', 'Vikas', 'Rahul', 'Suresh', 'Deepak', 'Ankit', 'Parth', 'Karan', 'Manish']
names_female = ['Priya', 'Neha', 'Anjali', 'Sonia', 'Riya', 'Pooja', 'Divya', 'Nidhi', 'Swati', 'Kavita']

students_data = []

# Generate 10 random student records
for i in range(1, 11):
    if i % 2 == 0:
        gender = 'Female'
        name = random.choice(names_female) + " " + random.choice(['Sharma', 'Verma', 'Patel', 'Singh', 'Kumar'])
    else:
        gender = 'Male'
        name = random.choice(names_male) + " " + random.choice(['Sharma', 'Verma', 'Patel', 'Singh', 'Kumar'])
    
    city = random.choice(cities)
    students_data.append((name, city, gender))

# Insert data
cursor.executemany('''
INSERT INTO students (s_name, s_city, s_gender) VALUES (?, ?, ?)
''', students_data)

conn.commit()

# Display inserted data
cursor.execute("SELECT * FROM students")
students = cursor.fetchall()

print("Students Table Created Successfully!")
print("\nStudent Records:")
print("-" * 60)
print(f"{'ID':<5} {'Name':<20} {'City':<15} {'Gender':<10}")
print("-" * 60)
for student in students:
    print(f"{student[0]:<5} {student[1]:<20} {student[2]:<15} {student[3]:<10}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>2. Dump students table data to CSV</h3>
            <button class="copy-btn" onclick="copyCode('code16')">Copy Code</button>
            <pre id="code16">import sqlite3
import csv

conn = sqlite3.connect('students.db')
cursor = conn.cursor()

# Fetch all data from students table
cursor.execute("SELECT * FROM students")
students = cursor.fetchall()

# Write to CSV file
with open('students.csv', 'w', newline='', encoding='utf-8') as file:
    writer = csv.writer(file)
    
    # Write header
    writer.writerow(['s_id', 's_name', 's_city', 's_gender'])
    
    # Write data
    writer.writerows(students)

print("Data dumped to students.csv successfully!")
print(f"Total records exported: {len(students)}")

# Verify by reading the CSV
print("\nFirst 5 records from CSV:")
with open('students.csv', 'r', newline='', encoding='utf-8') as file:
    reader = csv.reader(file)
    header = next(reader)
    print(f"Header: {header}")
    
    for i, row in enumerate(reader):
        if i < 5:
            print(f"Row {i+1}: {row}")
        else:
            break

conn.close()</pre>
        </div>

        <div class="question">
            <h3>3. Dump students data to students1.csv</h3>
            <button class="copy-btn" onclick="copyCode('code17')">Copy Code</button>
            <pre id="code17">import sqlite3
import csv

conn = sqlite3.connect('students.db')
cursor = conn.cursor()

# Fetch specific columns only
cursor.execute("SELECT s_name, s_city, s_gender FROM students")
students = cursor.fetchall()

# Write to CSV with different format
with open('students1.csv', 'w', newline='', encoding='utf-8') as file:
    writer = csv.writer(file)
    
    # Write header
    writer.writerow(['Student Name', 'City', 'Gender'])
    
    # Write data
    writer.writerows(students)

print("Data dumped to students1.csv successfully!")
print(f"Total records exported: {len(students)}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>4. Dump table structure and data to CSV</h3>
            <button class="copy-btn" onclick="copyCode('code18')">Copy Code</button>
            <pre id="code18">import sqlite3
import csv

conn = sqlite3.connect('students.db')
cursor = conn.cursor()

# Get table structure
cursor.execute("PRAGMA table_info(students)")
table_info = cursor.fetchall()

# Get data
cursor.execute("SELECT * FROM students")
data = cursor.fetchall()

# Write to CSV
with open('students2.csv', 'w', newline='', encoding='utf-8') as file:
    writer = csv.writer(file)
    
    # Write table structure
    writer.writerow(['=== TABLE STRUCTURE ==='])
    writer.writerow(['Column ID', 'Column Name', 'Data Type', 'Not Null', 'Default Value', 'Primary Key'])
    for info in table_info:
        writer.writerow(info)
    
    writer.writerow([])  # Empty row
    writer.writerow(['=== TABLE DATA ==='])
    
    # Write header
    headers = [info[1] for info in table_info]
    writer.writerow(headers)
    
    # Write data
    writer.writerows(data)

print("Table structure and data dumped to students2.csv successfully!")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>5. Import CSV and create students1 table</h3>
            <button class="copy-btn" onclick="copyCode('code19')">Copy Code</button>
            <pre id="code19">import sqlite3
import csv

conn = sqlite3.connect('students_import.db')
cursor = conn.cursor()

# Read CSV file
with open('students.csv', 'r', newline='', encoding='utf-8') as file:
    reader = csv.reader(file)
    header = next(reader)  # Read header
    
    # Create table based on CSV header
    create_table_sql = '''
    CREATE TABLE IF NOT EXISTS students1 (
        s_id INTEGER PRIMARY KEY,
        s_name TEXT NOT NULL,
        s_city TEXT NOT NULL,
        s_gender TEXT
    )
    '''
    cursor.execute(create_table_sql)
    
    # Insert data from CSV
    insert_count = 0
    for row in reader:
        try:
            cursor.execute('''
            INSERT INTO students1 (s_id, s_name, s_city, s_gender)
            VALUES (?, ?, ?, ?)
            ''', (int(row[0]), row[1], row[2], row[3]))
            insert_count += 1
        except Exception as e:
            print(f"Error inserting row {row}: {e}")
    
    conn.commit()

print(f"Table students1 created and {insert_count} records imported successfully!")

# Verify import
cursor.execute("SELECT COUNT(*) FROM students1")
count = cursor.fetchone()[0]
print(f"Total records in students1 table: {count}")

# Display first 3 records
cursor.execute("SELECT * FROM students1 LIMIT 3")
records = cursor.fetchall()
print("\nFirst 3 records:")
for record in records:
    print(record)

conn.close()</pre>
        </div>

        <div class="question">
            <h3>6. Create student database using Python</h3>
            <button class="copy-btn" onclick="copyCode('code20')">Copy Code</button>
            <pre id="code20">import sqlite3
import os

def create_student_database():
    """Create a complete student database"""
    
    # Create database file
    db_name = 'student_management.db'
    
    if os.path.exists(db_name):
        os.remove(db_name)  # Remove if exists for fresh start
        print(f"Removed existing {db_name}")
    
    conn = sqlite3.connect(db_name)
    cursor = conn.cursor()
    
    # Create students table
    cursor.execute('''
    CREATE TABLE students (
        student_id INTEGER PRIMARY KEY AUTOINCREMENT,
        first_name TEXT NOT NULL,
        last_name TEXT NOT NULL,
        enrollment_no TEXT UNIQUE NOT NULL,
        email TEXT UNIQUE,
        phone TEXT,
        birth_date DATE,
        enrollment_date DATE DEFAULT CURRENT_DATE
    )
    ''')
    
    # Create courses table
    cursor.execute('''
    CREATE TABLE courses (
        course_id INTEGER PRIMARY KEY AUTOINCREMENT,
        course_code TEXT UNIQUE NOT NULL,
        course_name TEXT NOT NULL,
        credits INTEGER DEFAULT 3,
        department TEXT
    )
    ''')
    
    # Create enrollments table
    cursor.execute('''
    CREATE TABLE enrollments (
        enrollment_id INTEGER PRIMARY KEY AUTOINCREMENT,
        student_id INTEGER,
        course_id INTEGER,
        enrollment_date DATE DEFAULT CURRENT_DATE,
        grade TEXT,
        FOREIGN KEY (student_id) REFERENCES students(student_id),
        FOREIGN KEY (course_id) REFERENCES courses(course_id)
    )
    ''')
    
    # Insert sample data
    # Students
    students = [
        ('John', 'Doe', 'ENR001', 'john@college.edu', '9876543210', '2000-05-15'),
        ('Jane', 'Smith', 'ENR002', 'jane@college.edu', '9876543211', '2001-03-22'),
        ('Bob', 'Johnson', 'ENR003', 'bob@college.edu', '9876543212', '1999-11-30'),
        ('Alice', 'Brown', 'ENR004', 'alice@college.edu', '9876543213', '2000-07-08')
    ]
    
    cursor.executemany('''
    INSERT INTO students (first_name, last_name, enrollment_no, email, phone, birth_date)
    VALUES (?, ?, ?, ?, ?, ?)
    ''', students)
    
    # Courses
    courses = [
        ('CS101', 'Introduction to Programming', 3, 'Computer Science'),
        ('CS102', 'Data Structures', 4, 'Computer Science'),
        ('MA101', 'Calculus I', 4, 'Mathematics'),
        ('PH101', 'Physics I', 4, 'Physics')
    ]
    
    cursor.executemany('''
    INSERT INTO courses (course_code, course_name, credits, department)
    VALUES (?, ?, ?, ?)
    ''', courses)
    
    # Enrollments
    enrollments = [
        (1, 1, 'A'),
        (1, 2, 'B+'),
        (2, 1, 'A'),
        (2, 3, 'B'),
        (3, 2, 'A-'),
        (4, 4, 'A')
    ]
    
    cursor.executemany('''
    INSERT INTO enrollments (student_id, course_id, grade)
    VALUES (?, ?, ?)
    ''', enrollments)
    
    conn.commit()
    
    # Display database info
    print("\n=== STUDENT DATABASE CREATED SUCCESSFULLY ===")
    print(f"Database file: {db_name}")
    
    cursor.execute("SELECT COUNT(*) FROM students")
    student_count = cursor.fetchone()[0]
    
    cursor.execute("SELECT COUNT(*) FROM courses")
    course_count = cursor.fetchone()[0]
    
    cursor.execute("SELECT COUNT(*) FROM enrollments")
    enrollment_count = cursor.fetchone()[0]
    
    print(f"• Students: {student_count}")
    print(f"• Courses: {course_count}")
    print(f"• Enrollments: {enrollment_count}")
    
    # Show tables
    cursor.execute("SELECT name FROM sqlite_master WHERE type='table'")
    tables = cursor.fetchall()
    print(f"\nTables created: {[table[0] for table in tables]}")
    
    conn.close()
    return db_name

# Run the function
db_file = create_student_database()
print(f"\nDatabase ready: {db_file}")</pre>
        </div>

        <div class="question">
            <h3>7. Create 'std' table in student database</h3>
            <button class="copy-btn" onclick="copyCode('code21')">Copy Code</button>
            <pre id="code21">import sqlite3

def create_std_table():
    conn = sqlite3.connect('student.db')
    cursor = conn.cursor()
    
    # Create std table
    cursor.execute('''
    CREATE TABLE IF NOT EXISTS std (
        std_id INTEGER PRIMARY KEY AUTOINCREMENT,
        std_name TEXT NOT NULL,
        std_city TEXT NOT NULL,
        std_gender TEXT CHECK(std_gender IN ('Male', 'Female', 'Other')),
        std_mob_no TEXT UNIQUE CHECK(length(std_mob_no) = 10)
    )
    ''')
    
    print("'std' table created successfully!")
    
    # Show table structure
    cursor.execute("PRAGMA table_info(std)")
    columns = cursor.fetchall()
    
    print("\nTable Structure:")
    print("-" * 60)
    print(f"{'Column':<15} {'Type':<15} {'Not Null':<10} {'Primary Key':<12}")
    print("-" * 60)
    for col in columns:
        print(f"{col[1]:<15} {col[2]:<15} {str(col[3]):<10} {str(col[5]):<12}")
    
    conn.close()

create_std_table()</pre>
        </div>

        <div class="question">
            <h3>8. Insert 10 records using execute query</h3>
            <button class="copy-btn" onclick="copyCode('code22')">Copy Code</button>
            <pre id="code22">import sqlite3
import random

conn = sqlite3.connect('student.db')
cursor = conn.cursor()

# Ensure table exists
cursor.execute('''
CREATE TABLE IF NOT EXISTS std (
    std_id INTEGER PRIMARY KEY AUTOINCREMENT,
    std_name TEXT NOT NULL,
    std_city TEXT NOT NULL,
    std_gender TEXT CHECK(std_gender IN ('Male', 'Female', 'Other')),
    std_mob_no TEXT UNIQUE CHECK(length(std_mob_no) = 10)
)
''')

# Sample data
cities = ['Surat', 'Mumbai', 'Delhi', 'Bangalore', 'Chennai', 'Kolkata', 'Pune', 'Jaipur']
first_names = ['Raj', 'Amit', 'Priya', 'Neha', 'Vikas', 'Anjali', 'Rahul', 'Sonia', 'Deepak', 'Riya']
last_names = ['Sharma', 'Verma', 'Patel', 'Singh', 'Kumar', 'Gupta', 'Jain', 'Mehta', 'Reddy', 'Nair']

# Generate and insert 10 records
records_inserted = 0
mobile_start = 9876500000

for i in range(10):
    first_name = random.choice(first_names)
    last_name = random.choice(last_names)
    full_name = f"{first_name} {last_name}"
    city = random.choice(cities)
    gender = 'Male' if first_name in ['Raj', 'Amit', 'Vikas', 'Rahul', 'Deepak'] else 'Female'
    mobile = str(mobile_start + i)
    
    try:
        cursor.execute('''
        INSERT INTO std (std_name, std_city, std_gender, std_mob_no)
        VALUES (?, ?, ?, ?)
        ''', (full_name, city, gender, mobile))
        records_inserted += 1
        print(f"Inserted: {full_name} from {city}")
    except sqlite3.IntegrityError as e:
        print(f"Skipped duplicate mobile for {full_name}: {mobile}")

conn.commit()

print(f"\nTotal records inserted: {records_inserted}")

# Display all records
cursor.execute("SELECT * FROM std")
students = cursor.fetchall()

print("\nAll Student Records:")
print("-" * 80)
print(f"{'ID':<5} {'Name':<20} {'City':<15} {'Gender':<10} {'Mobile':<12}")
print("-" * 80)
for student in students:
    print(f"{student[0]:<5} {student[1]:<20} {student[2]:<15} {student[3]:<10} {student[4]:<12}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>9. Connect to student database with Python</h3>
            <button class="copy-btn" onclick="copyCode('code23')">Copy Code</button>
            <pre id="code23">import sqlite3

def connect_student_db():
    """Connect to student database and perform operations"""
    
    try:
        # Connect to database
        conn = sqlite3.connect('student.db')
        cursor = conn.cursor()
        
        print("✓ Successfully connected to student database!")
        print(f"Database file: student.db")
        
        # Check connection
        cursor.execute("SELECT sqlite_version()")
        version = cursor.fetchone()[0]
        print(f"SQLite version: {version}")
        
        # Get list of tables
        cursor.execute("SELECT name FROM sqlite_master WHERE type='table'")
        tables = cursor.fetchall()
        
        print(f"\nTables in database:")
        for table in tables:
            print(f"  • {table[0]}")
            
            # Get row count for each table
            cursor.execute(f"SELECT COUNT(*) FROM {table[0]}")
            count = cursor.fetchone()[0]
            print(f"    Records: {count}")
        
        # Show sample data from std table if exists
        if 'std' in [table[0] for table in tables]:
            print("\nSample data from 'std' table (first 3 records):")
            cursor.execute("SELECT * FROM std LIMIT 3")
            sample_data = cursor.fetchall()
            
            for row in sample_data:
                print(f"  ID: {row[0]}, Name: {row[1]}, City: {row[2]}")
        
        return conn, cursor
        
    except sqlite3.Error as e:
        print(f"✗ Database connection error: {e}")
        return None, None

# Test the connection
if __name__ == "__main__":
    connection, cursor = connect_student_db()
    
    if connection:
        # Perform a simple query
        cursor.execute("SELECT COUNT(*) FROM std")
        total_students = cursor.fetchone()[0]
        print(f"\nTotal students in database: {total_students}")
        
        # Close connection
        connection.close()
        print("\n✓ Database connection closed.")</pre>
        </div>

        <div class="question">
            <h3>10. Update name where city is Surat</h3>
            <button class="copy-btn" onclick="copyCode('code24')">Copy Code</button>
            <pre id="code24">import sqlite3

conn = sqlite3.connect('student.db')
cursor = conn.cursor()

print("Before update:")
cursor.execute("SELECT std_id, std_name, std_city FROM std WHERE std_city = 'Surat'")
surat_students = cursor.fetchall()

if surat_students:
    print(f"Students from Surat ({len(surat_students)} found):")
    for student in surat_students:
        print(f"  ID: {student[0]}, Name: {student[1]}")
else:
    print("No students found from Surat")
    # Add some Surat students for demonstration
    cursor.execute("UPDATE std SET std_city = 'Surat' WHERE std_id IN (1, 3, 5)")
    conn.commit()
    print("Added Surat as city for students with IDs 1, 3, 5")

# Get total changes before update
cursor.execute("SELECT total_changes()")
changes_before = cursor.fetchone()[0]
print(f"\nTotal changes before update: {changes_before}")

# Update names for students from Surat
update_query = """
UPDATE std 
SET std_name = std_name || ' (Surat Resident)'
WHERE std_city = 'Surat'
"""

cursor.execute(update_query)
conn.commit()

# Get total changes after update
cursor.execute("SELECT total_changes()")
changes_after = cursor.fetchone()[0]
changes_made = changes_after - changes_before

print(f"Total changes after update: {changes_after}")
print(f"Number of records updated: {changes_made}")

# Show updated records
print("\nAfter update:")
cursor.execute("SELECT std_id, std_name, std_city FROM std WHERE std_city = 'Surat'")
updated_students = cursor.fetchall()

if updated_students:
    print("Updated students from Surat:")
    for student in updated_students:
        print(f"  ID: {student[0]}, Name: {student[1]}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>11. Delete record where std_id is 106</h3>
            <button class="copy-btn" onclick="copyCode('code25')">Copy Code</button>
            <pre id="code25">import sqlite3

conn = sqlite3.connect('student.db')
cursor = conn.cursor()

# First, check if student with ID 106 exists
cursor.execute("SELECT * FROM std WHERE std_id = 106")
student = cursor.fetchone()

if student:
    print(f"Student found with ID 106:")
    print(f"  Name: {student[1]}")
    print(f"  City: {student[2]}")
    print(f"  Mobile: {student[4]}")
    
    # Delete the student
    cursor.execute("DELETE FROM std WHERE std_id = 106")
    conn.commit()
    
    print(f"\n✓ Student with ID 106 deleted successfully!")
    
    # Verify deletion
    cursor.execute("SELECT * FROM std WHERE std_id = 106")
    if cursor.fetchone() is None:
        print("✓ Verification: Student no longer exists in database")
    else:
        print("✗ Error: Student still exists!")
        
    # Show remaining student count
    cursor.execute("SELECT COUNT(*) FROM std")
    remaining = cursor.fetchone()[0]
    print(f"\nTotal students remaining: {remaining}")
    
else:
    print("No student found with ID 106")
    
    # For demonstration, create a student with ID 106
    print("\nCreating student with ID 106 for demonstration...")
    cursor.execute('''
    INSERT INTO std (std_id, std_name, std_city, std_gender, std_mob_no)
    VALUES (106, 'Demo Student', 'Demo City', 'Male', '9876510101')
    ''')
    conn.commit()
    print("✓ Created demo student with ID 106")
    
    # Now delete it
    cursor.execute("DELETE FROM std WHERE std_id = 106")
    conn.commit()
    print("✓ Deleted demo student with ID 106")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>12. Display record using fetchone()</h3>
            <button class="copy-btn" onclick="copyCode('code26')">Copy Code</button>
            <pre id="code26">import sqlite3

conn = sqlite3.connect('student.db')
cursor = conn.cursor()

print("Using fetchone() to retrieve single record:")
print("-" * 50)

# Get first student
cursor.execute("SELECT * FROM std ORDER BY std_id LIMIT 1")
student = cursor.fetchone()

if student:
    print("First student record:")
    print(f"  ID: {student[0]}")
    print(f"  Name: {student[1]}")
    print(f"  City: {student[2]}")
    print(f"  Gender: {student[3]}")
    print(f"  Mobile: {student[4]}")
else:
    print("No students found in database")

print("\n" + "="*50)
print("Using fetchone() in a loop (manual iteration):")
print("-" * 50)

cursor.execute("SELECT std_id, std_name, std_city FROM std ORDER BY std_id")

count = 0
while True:
    student = cursor.fetchone()
    if student is None:
        break
    
    count += 1
    if count <= 3:  # Show only first 3
        print(f"Student {count}: ID={student[0]}, Name={student[1]}, City={student[2]}")
    
    if count == 5:  # Stop after 5 for demonstration
        break

print(f"\nTotal students processed: {count}")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>13. Display records using fetchall()</h3>
            <button class="copy-btn" onclick="copyCode('code27')">Copy Code</button>
            <pre id="code27">import sqlite3

conn = sqlite3.connect('student.db')
cursor = conn.cursor()

print("Using fetchall() to retrieve all records:")
print("-" * 80)

# Get all students
cursor.execute("SELECT * FROM std ORDER BY std_id")
all_students = cursor.fetchall()

print(f"Total students retrieved: {len(all_students)}")

if all_students:
    print("\nAll Student Records:")
    print("-" * 80)
    print(f"{'ID':<5} {'Name':<20} {'City':<15} {'Gender':<10} {'Mobile':<12}")
    print("-" * 80)
    
    for student in all_students:
        print(f"{student[0]:<5} {student[1]:<20} {student[2]:<15} {student[3]:<10} {student[4]:<12}")
else:
    print("No students found in database")

print("\n" + "="*80)
print("Using fetchall() with specific columns:")
print("-" * 80)

cursor.execute("SELECT std_name, std_city, std_gender FROM std ORDER BY std_city, std_name")
students_by_city = cursor.fetchall()

# Group by city
cities = {}
for name, city, gender in students_by_city:
    if city not in cities:
        cities[city] = []
    cities[city].append((name, gender))

print("\nStudents grouped by city:")
for city, students in cities.items():
    print(f"\n{city} ({len(students)} students):")
    for name, gender in students:
        print(f"  • {name} ({gender})")

conn.close()</pre>
        </div>

        <div class="question">
            <h3>14. Save data using commit() command</h3>
            <button class="copy-btn" onclick="copyCode('code28')">Copy Code</button>
            <pre id="code28">import sqlite3

def demonstrate_commit():
    """Demonstrate the importance of commit()"""
    
    print("Demonstrating commit() functionality:")
    print("=" * 60)
    
    # Create a temporary database in memory
    conn = sqlite3.connect(':memory:')
    cursor = conn.cursor()
    
    # Create a test table
    cursor.execute('''
    CREATE TABLE test_data (
        id INTEGER PRIMARY KEY,
        name TEXT,
        value INTEGER
    )
    ''')
    
    # Insert data WITHOUT commit
    print("\n1. Inserting data WITHOUT commit():")
    cursor.execute("INSERT INTO test_data (name, value) VALUES ('Test1', 100)")
    cursor.execute("INSERT INTO test_data (name, value) VALUES ('Test2', 200)")
    
    # Check if data is visible in current connection
    cursor.execute("SELECT COUNT(*) FROM test_data")
    count_before = cursor.fetchone()[0]
    print(f"   Records visible in current connection: {count_before}")
    
    # Close connection without commit
    conn.close()
    
    # Reconnect (in-memory DB is fresh)
    conn = sqlite3.connect(':memory:')
    cursor = conn.cursor()
    cursor.execute('''
    CREATE TABLE test_data (
        id INTEGER PRIMARY KEY,
        name TEXT,
        value INTEGER
    )
    ''')
    
    # Now insert data WITH commit
    print("\n2. Inserting data WITH commit():")
    cursor.execute("INSERT INTO test_data (name, value) VALUES ('Test1', 100)")
    cursor.execute("INSERT INTO test_data (name, value) VALUES ('Test2', 200)")
    
    # Commit the transaction
    conn.commit()
    print("   ✓ commit() executed")
    
    cursor.execute("SELECT COUNT(*) FROM test_data")
    count_after_commit = cursor.fetchone()[0]
    print(f"   Records after commit: {count_after_commit}")
    
    # Simulate crash/reconnection
    print("\n3. Simulating reconnection (like program restart):")
    conn.close()
    conn = sqlite3.connect(':memory:')  # Fresh in-memory DB
    
    # But for file-based DB, data would persist
    print("\n4. File-based database example:")
    
    file_conn = sqlite3.connect('test_commit.db')
    file_cursor = file_conn.cursor()
    
    file_cursor.execute('''
    CREATE TABLE IF NOT EXISTS persistent_data (
        id INTEGER PRIMARY KEY,
        data TEXT,
        timestamp DATETIME DEFAULT CURRENT_TIMESTAMP
    )
    ''')
    
    # Insert without commit
    file_cursor.execute("INSERT INTO persistent_data (data) VALUES ('No commit data')")
    print("   Inserted data without commit")
    
    # Insert with commit
    file_cursor.execute("INSERT INTO persistent_data (data) VALUES ('With commit data')")
    file_conn.commit()
    print("   Inserted data with commit")
    
    # Check what's actually saved
    file_cursor.execute("SELECT data FROM persistent_data")
    saved_data = file_cursor.fetchall()
    
    print(f"\n   Data actually saved to file:")
    for data in saved_data:
        print(f"   • {data[0]}")
    
    file_conn.close()
    
    print("\n" + "="*60)
    print("Key Points:")
    print("1. commit() makes changes permanent in the database file")
    print("2. Without commit(), changes are only visible in current connection")
    print("3. After program restart, only committed data persists")
    print("4. Always use commit() after INSERT, UPDATE, DELETE operations")

# Run the demonstration
demonstrate_commit()</pre>
        </div>

        <div class="question">
            <h3>15. Import module and use its functions</h3>
            <button class="copy-btn" onclick="copyCode('code29')">Copy Code</button>
            <pre id="code29"># ================ student_module.py ================
"""
student_module.py - Module containing student database functions
"""
import sqlite3

def create_student_table():
    """Create student table if not exists"""
    conn = sqlite3.connect('student_module.db')
    cursor = conn.cursor()
    
    cursor.execute('''
    CREATE TABLE IF NOT EXISTS module_students (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        name TEXT NOT NULL,
        grade TEXT,
        marks INTEGER
    )
    ''')
    
    conn.commit()
    conn.close()
    print("Student table created in module")

def add_student(name, grade, marks):
    """Add a new student"""
    conn = sqlite3.connect('student_module.db')
    cursor = conn.cursor()
    
    cursor.execute('''
    INSERT INTO module_students (name, grade, marks)
    VALUES (?, ?, ?)
    ''', (name, grade, marks))
    
    conn.commit()
    student_id = cursor.lastrowid
    conn.close()
    
    print(f"Added student: {name} with ID: {student_id}")
    return student_id

def get_all_students():
    """Get all students"""
    conn = sqlite3.connect('student_module.db')
    cursor = conn.cursor()
    
    cursor.execute("SELECT * FROM module_students")
    students = cursor.fetchall()
    
    conn.close()
    return students

def calculate_average_marks():
    """Calculate average marks of all students"""
    conn = sqlite3.connect('student_module.db')
    cursor = conn.cursor()
    
    cursor.execute("SELECT AVG(marks) FROM module_students")
    average = cursor.fetchone()[0]
    
    conn.close()
    return average if average else 0

# ================ main_program.py ================
"""
main_program.py - Main program that imports and uses student_module
"""
print("=" * 60)
print("MODULE IMPORT DEMONSTRATION")
print("=" * 60)

# Method 1: Import entire module
print("\n1. Importing entire module:")
print("-" * 40)
import student_module

# Use module functions
student_module.create_student_table()

# Add some students
student_module.add_student("Alice Johnson", "A", 95)
student_module.add_student("Bob Smith", "B", 82)
student_module.add_student("Charlie Brown", "A+", 98)

# Get all students
students = student_module.get_all_students()
print(f"\nAll students from module:")
for student in students:
    print(f"  ID: {student[0]}, Name: {student[1]}, Grade: {student[2]}, Marks: {student[3]}")

# Calculate average
average = student_module.calculate_average_marks()
print(f"\nAverage marks: {average:.2f}")

print("\n" + "=" * 60)
print("2. Import specific functions:")
print("-" * 40)

# Method 2: Import specific functions
from student_module import add_student, get_all_students

# Use imported functions directly
new_id = add_student("David Wilson", "B+", 88)
print(f"Added new student with ID: {new_id}")

# Get updated list
updated_students = get_all_students()
print(f"\nTotal students: {len(updated_students)}")

print("\n" + "=" * 60)
print("3. Import with alias:")
print("-" * 40)

# Method 3: Import with alias
import student_module as sm

# Use with alias
avg_from_alias = sm.calculate_average_marks()
print(f"Average marks (via alias): {avg_from_alias:.2f}")

print("\n" + "=" * 60)
print("MODULE INFORMATION:")
print("-" * 40)

# Get module info
print(f"Module name: {student_module.__name__}")
print(f"Module file: {student_module.__file__ if hasattr(student_module, '__file__') else 'Built-in'}")
print(f"Module documentation: {student_module.__doc__}")

print("\nAvailable functions in module:")
import inspect
functions = inspect.getmembers(student_module, inspect.isfunction)
for name, func in functions:
    print(f"  • {name}(): {func.__doc__}")

print("\n" + "=" * 60)
print("✓ Module import demonstration completed successfully!")</pre>
        </div>
    </div>

    <!-- Practical 4 & 5 Content -->
    <div id="practical45" class="content">
        <h2>Practical 4 & 5: CSV/Excel Operations and Data Analysis</h2>

        <div class="question">
            <h3>1. Create emp.csv file using csv.writer()</h3>
            <button class="copy-btn" onclick="copyCode('code30')">Copy Code</button>
            <pre id="code30">import csv

# Sample employee data
employees = [
    [1, 'John Doe', 'New York', '1234567890'],
    [2, 'Jane Smith', 'London', '0987654321'],
    [3, 'Bob Johnson', 'Paris', '1122334455'],
    [4, 'Alice Brown', 'Tokyo', '2233445566'],
    [5, 'Charlie Davis', 'Berlin', '3344556677'],
    [6, 'Diana Miller', 'Mumbai', '4455667788'],
    [7, 'Ethan Wilson', 'Delhi', '5566778899'],
    [8, 'Fiona Garcia', 'Sydney', '6677889900']
]

# Write to CSV file
with open('emp.csv', 'w', newline='', encoding='utf-8') as file:
    writer = csv.writer(file)
    
    # Write header
    writer.writerow(['id', 'name', 'city', 'mobno'])
    
    # Write data
    writer.writerows(employees)

print("emp.csv file created successfully!")
print(f"Total records written: {len(employees)}")

# Verify by reading first 3 rows
print("\nFirst 3 records from emp.csv:")
with open('emp.csv', 'r', newline='', encoding='utf-8') as file:
    reader = csv.reader(file)
    for i, row in enumerate(reader):
        if i < 4:  # Include header + 3 data rows
            print(row)
        else:
            break

# Alternative: Using DictWriter
print("\n" + "="*50)
print("Creating emp_dict.csv using csv.DictWriter():")

employees_dict = [
    {'id': 101, 'name': 'Raj Patel', 'city': 'Surat', 'mobno': '9876543210'},
    {'id': 102, 'name': 'Priya Sharma', 'city': 'Mumbai', 'mobno': '9876543211'},
    {'id': 103, 'name': 'Amit Kumar', 'city': 'Delhi', 'mobno': '9876543212'}
]

with open('emp_dict.csv', 'w', newline='', encoding='utf-8') as file:
    fieldnames = ['id', 'name', 'city', 'mobno']
    writer = csv.DictWriter(file, fieldnames=fieldnames)
    
    writer.writeheader()
    writer.writerows(employees_dict)

print("emp_dict.csv created using DictWriter!")</pre>
        </div>

        <div class="question">
            <h3>2. Read CSV file using csv.reader()</h3>
            <button class="copy-btn" onclick="copyCode('code31')">Copy Code</button>
            <pre id="code31">import csv

print("Reading emp.csv using csv.reader():")
print("-" * 60)

# Read CSV file
with open('emp.csv', 'r', newline='', encoding='utf-8') as file:
    reader = csv.reader(file)
    
    # Get header
    header = next(reader)
    print(f"Header: {header}")
    
    print("\nEmployee Data:")
    print("-" * 60)
    
    # Read and display all rows
    for i, row in enumerate(reader, 1):
        print(f"Row {i}: ID={row[0]}, Name={row[1]}, City={row[2]}, Mobile={row[3]}")

print("\n" + "="*60)
print("Processing CSV data with calculations:")

# Re-read for calculations
with open('emp.csv', 'r', newline='', encoding='utf-8') as file:
    reader = csv.reader(file)
    next(reader)  # Skip header
    
    # Convert to list for processing
    employees = list(reader)
    
    print(f"Total employees: {len(employees)}")
    
    # Group by city
    city_count = {}
    for row in employees:
        city = row[2]
        city_count[city] = city_count.get(city, 0) + 1
    
    print("\nEmployees by city:")
    for city, count in city_count.items():
        print(f"  {city}: {count} employees")

print("\n" + "="*60)
print("Reading with error handling:")

try:
    with open('emp.csv', 'r', newline='', encoding='utf-8') as file:
        reader = csv.reader(file)
        
        # Skip header
        next(reader)
        
        # Read with validation
        valid_rows = []
        invalid_rows = []
        
        for i, row in enumerate(reader, 2):  # Start from row 2 (after header)
            if len(row) == 4 and row[0].isdigit():
                valid_rows.append(row)
            else:
                invalid_rows.append((i, row))
        
        print(f"Valid rows: {len(valid_rows)}")
        print(f"Invalid rows: {len(invalid_rows)}")
        
        if invalid_rows:
            print("\nInvalid rows found:")
            for row_num, row in invalid_rows:
                print(f"  Row {row_num}: {row}")
                
except FileNotFoundError:
    print("Error: emp.csv file not found!")
except Exception as e:
    print(f"Error reading CSV: {e}")</pre>
        </div>

        <div class="question">
            <h3>3. Read Excel file using pandas</h3>
            <button class="copy-btn" onclick="copyCode('code32')">Copy Code</button>
            <pre id="code32">import pandas as pd
import os

# First, create a sample students.xlsx file if it doesn't exist
print("Creating sample students.xlsx file...")

# Sample student data
students_data = {
    'StudentID': [101, 102, 103, 104, 105, 106, 107, 108, 109, 110],
    'Name': ['Alice Johnson', 'Bob Smith', 'Charlie Brown', 'Diana Prince', 
             'Ethan Hunt', 'Fiona Gallagher', 'George Miller', 'Hannah Davis',
             'Ian Collins', 'Jessica Taylor'],
    'Age': [20, 21, 22, 20, 23, 21, 22, 20, 23, 21],
    'Course': ['CS', 'Math', 'Physics', 'CS', 'Chemistry', 'Math', 'Physics', 
               'CS', 'Chemistry', 'Math'],
    'Grade': ['A', 'B+', 'A-', 'B', 'A', 'B+', 'A-', 'B', 'A', 'B+'],
    'Marks': [95, 82, 88, 76, 92, 85, 87, 78, 91, 83],
    'City': ['New York', 'London', 'Paris', 'Tokyo', 'Berlin', 'Mumbai', 
             'Delhi', 'Sydney', 'Toronto', 'Singapore']
}

# Create DataFrame
df = pd.DataFrame(students_data)

# Save to Excel
df.to_excel('students.xlsx', index=False, sheet_name='Students')

print("✓ students.xlsx file created successfully!")
print(f"Total records: {len(df)}")

print("\n" + "="*60)
print("Reading Excel file using pandas:")
print("-" * 60)

# Read the Excel file
try:
    # Read entire Excel file
    df = pd.read_excel('students.xlsx', sheet_name='Students')
    
    print("Excel file loaded successfully!")
    print(f"Shape: {df.shape[0]} rows x {df.shape[1]} columns")
    
    # Display basic info
    print("\nFile Information:")
    print(f"Columns: {list(df.columns)}")
    print(f"Data types:\n{df.dtypes}")
    
    # Display first few rows
    print("\nFirst 5 rows:")
    print(df.head())
    
    print("\n" + "="*60)
    print("Data Analysis:")
    print("-" * 60)
    
    # Basic statistics
    print("\nBasic Statistics:")
    print(df.describe())
    
    # Group by Course
    print("\nStudents by Course:")
    course_counts = df['Course'].value_counts()
    print(course_counts)
    
    # Average marks by course
    print("\nAverage Marks by Course:")
    avg_marks = df.groupby('Course')['Marks'].mean()
    print(avg_marks)
    
except FileNotFoundError:
    print("Error: students.xlsx file not found!")
except ImportError:
    print("Error: pandas library not installed. Install with: pip install pandas openpyxl")
except Exception as e:
    print(f"Error reading Excel file: {e}")

print("\n" + "="*60)
print("Reading specific sheet and range:")
print("-" * 60)

# Read specific rows/columns
try:
    # Read only first 5 rows
    df_first5 = pd.read_excel('students.xlsx', nrows=5)
    print("First 5 rows only:")
    print(df_first5)
    
    # Read specific columns
    df_specific = pd.read_excel('students.xlsx', usecols=['Name', 'Course', 'Marks'])
    print("\nSpecific columns (Name, Course, Marks):")
    print(df_specific.head())
    
    # Read with custom header
    df_custom = pd.read_excel('students.xlsx', header=0, names=['ID', 'FullName', 'StudentAge', 
                                                                'Subject', 'LetterGrade', 'Score', 'Location'])
    print("\nWith custom column names:")
    print(df_custom.head())
    
except Exception as e:
    print(f"Error: {e}")</pre>
        </div>

        <div class="question">
            <h3>4. Calculate total rows and columns</h3>
            <button class="copy-btn" onclick="copyCode('code33')">Copy Code</button>
            <pre id="code33">import pandas as pd
import openpyxl  # For direct Excel manipulation

print("=" * 60)
print("METHOD 1: Using pandas")
print("=" * 60)

# Method 1: Using pandas
try:
    df = pd.read_excel('students.xlsx')
    
    rows = df.shape[0]
    columns = df.shape[1]
    
    print(f"Using pandas:")
    print(f"Total rows: {rows}")
    print(f"Total columns: {columns}")
    print(f"Total cells: {rows * columns}")
    
    # Get detailed column info
    print("\nColumn Details:")
    for i, col in enumerate(df.columns, 1):
        non_null = df[col].count()
        null_count = rows - non_null
        dtype = df[col].dtype
        print(f"{i:2}. {col:<15} Type: {str(dtype):<10} Non-null: {non_null:3} Null: {null_count:3}")
    
except Exception as e:
    print(f"Pandas error: {e}")

print("\n" + "=" * 60)
print("METHOD 2: Using openpyxl")
print("=" * 60)

# Method 2: Using openpyxl directly
try:
    from openpyxl import load_workbook
    
    workbook = load_workbook('students.xlsx', read_only=True)
    sheet = workbook.active
    
    # Count rows (skip empty rows at the end)
    max_row = sheet.max_row
    max_column = sheet.max_column
    
    print(f"Using openpyxl:")
    print(f"Maximum rows: {max_row}")
    print(f"Maximum columns: {max_column}")
    
    # Count actual non-empty rows
    actual_rows = 0
    for row in sheet.iter_rows(min_row=2, max_row=max_row):  # Skip header
        if any(cell.value is not None for cell in row):
            actual_rows += 1
    
    print(f"Actual data rows (excluding header): {actual_rows}")
    
    # Count non-empty columns
    actual_cols = 0
    for col in range(1, max_column + 1):
        col_has_data = False
        for row in range(2, max_row + 1):  # Skip header
            if sheet.cell(row=row, column=col).value is not None:
                col_has_data = True
                break
        if col_has_data:
            actual_cols += 1
    
    print(f"Actual data columns: {actual_cols}")
    
    workbook.close()
    
except ImportError:
    print("openpyxl not installed. Install with: pip install openpyxl")
except Exception as e:
    print(f"Openpyxl error: {e}")

print("\n" + "=" * 60)
print("METHOD 3: Manual CSV-style reading")
print("=" * 60)

# Method 3: Manual reading
try:
    import xlrd  # Alternative Excel reader
    
    workbook = xlrd.open_workbook('students.xlsx')
    sheet = workbook.sheet_by_index(0)
    
    print(f"Using xlrd:")
    print(f"Rows: {sheet.nrows}")
    print(f"Columns: {sheet.ncols}")
    
    # Count non-empty rows
    non_empty_rows = 0
    for i in range(sheet.nrows):
        row_values = sheet.row_values(i)
        if any(str(val).strip() for val in row_values):
            non_empty_rows += 1
    
    # Count non-empty columns
    non_empty_cols = 0
    for j in range(sheet.ncols):
        col_values = sheet.col_values(j)
        if any(str(val).strip() for val in col_values[1:]):  # Skip header
            non_empty_cols += 1
    
    print(f"Non-empty rows: {non_empty_rows}")
    print(f"Non-empty columns: {non_empty_cols}")
    
    # Display dimensions in different formats
    print("\nFile Dimensions:")
    print(f"• Rows × Columns: {sheet.nrows} × {sheet.ncols}")
    print(f"• Total cells: {sheet.nrows * sheet.ncols}")
    print(f"• Data range: A1:{xlrd.colname(sheet.ncols-1)}{sheet.nrows}")
    
except ImportError:
    print("xlrd not installed. Install with: pip install xlrd")
except Exception as e:
    print(f"Xlrd error: {e}")

print("\n" + "=" * 60)
print("Summary Function:")
print("=" * 60)

def get_excel_dimensions(file_path):
    """Get dimensions of Excel file using available methods"""
    dimensions = {}
    
    try:
        # Try pandas first
        df = pd.read_excel(file_path)
        dimensions['pandas_rows'] = df.shape[0]
        dimensions['pandas_cols'] = df.shape[1]
        dimensions['method'] = 'pandas'
    except:
        pass
    
    try:
        # Try openpyxl
        from openpyxl import load_workbook
        wb = load_workbook(file_path, read_only=True)
        ws = wb.active
        dimensions['openpyxl_max_rows'] = ws.max_row
        dimensions['openpyxl_max_cols'] = ws.max_column
        dimensions['method'] = 'openpyxl'
        wb.close()
    except:
        pass
    
    return dimensions

# Test the function
dims = get_excel_dimensions('students.xlsx')
print("File dimensions summary:")
for key, value in dims.items():
    print(f"  {key}: {value}")</pre>
        </div>

        <div class="question">
            <h3>5. Print first record from Excel file</h3>
            <button class="copy-btn" onclick="copyCode('code34')">Copy Code</button>
            <pre id="code34">import pandas as pd

print("First record from students.xlsx:")
print("=" * 60)

try:
    # Read Excel file
    df = pd.read_excel('students.xlsx')
    
    # Get first record (excluding header)
    first_record = df.iloc[0]
    
    print("Complete first record:")
    print("-" * 60)
    
    # Display all columns
    for column, value in first_record.items():
        print(f"{column:15}: {value}")
    
    print("\n" + "=" * 60)
    print("Alternative methods to get first record:")
    print("-" * 60)
    
    # Method 1: Using iloc
    print("\nMethod 1 - Using iloc[0]:")
    print(df.iloc[0])
    
    # Method 2: Using head
    print("\nMethod 2 - Using head(1):")
    print(df.head(1))
    
    # Method 3: Using loc with index
    print("\nMethod 3 - Using loc[0]:")
    print(df.loc[0])
    
    # Method 4: Convert to dictionary
    print("\nMethod 4 - As dictionary:")
    first_dict = df.iloc[0].to_dict()
    for key, value in first_dict.items():
        print(f"  {key}: {value}")
    
    print("\n" + "=" * 60)
    print("First record with specific columns only:")
    print("-" * 60)
    
    # Select specific columns
    selected_columns = ['Name', 'Age', 'Course', 'Marks']
    first_record_selected = df[selected_columns].iloc[0]
    
    print("First student details:")
    for col in selected_columns:
        print(f"  {col}: {first_record_selected[col]}")
    
    # Format output
    print("\n" + "=" * 60)
    print("Formatted output:")
    print("-" * 60)
    
    print(f"""
    FIRST STUDENT RECORD
    ====================
    Student ID  : {first_record['StudentID']}
    Name        : {first_record['Name']}
    Age         : {first_record['Age']} years
    Course      : {first_record['Course']}
    Grade       : {first_record['Grade']}
    Marks       : {first_record['Marks']}/100
    City        : {first_record['City']}
    """)
    
    print("\n" + "=" * 60)
    print("First record from each sheet (if multiple sheets):")
    print("-" * 60)
    
    # Check for multiple sheets
    excel_file = pd.ExcelFile('students.xlsx')
    sheet_names = excel_file.sheet_names
    
    if len(sheet_names) > 1:
        print(f"Multiple sheets found: {sheet_names}")
        for sheet in sheet_names:
            df_sheet = pd.read_excel('students.xlsx', sheet_name=sheet)
            if not df_sheet.empty:
                print(f"\nFirst record from '{sheet}' sheet:")
                print(df_sheet.iloc[0])
    else:
        print(f"Only one sheet found: '{sheet_names[0]}'")
    
except FileNotFoundError:
    print("Error: students.xlsx file not found!")
    print("Creating sample file...")
    
    # Create sample data
    data = {'StudentID': [101], 'Name': ['Sample Student'], 'Age': [20], 
            'Course': ['CS'], 'Grade': ['A'], 'Marks': [95], 'City': ['Sample City']}
    df_sample = pd.DataFrame(data)
    df_sample.to_excel('students.xlsx', index=False)
    print("Sample students.xlsx created. Please run the code again.")
    
except Exception as e:
    print(f"Error: {e}")</pre>
        </div>

        <div class="question">
            <h3>6. Print last record from Excel file</h3>
            <button class="copy-btn" onclick="copyCode('code35')">Copy Code</button>
            <pre id="code35">import pandas as pd

print("Last record from students.xlsx:")
print("=" * 60)

try:
    # Read Excel file
    df = pd.read_excel('students.xlsx')
    
    total_records = len(df)
    print(f"Total records in file: {total_records}")
    
    # Get last record
    last_record = df.iloc[-1]
    
    print("\nComplete last record:")
    print("-" * 60)
    
    # Display all columns
    for column, value in last_record.items():
        print(f"{column:15}: {value}")
    
    print("\n" + "=" * 60)
    print("Different methods to get last record:")
    print("-" * 60)
    
    # Method 1: Using iloc[-1]
    print("\nMethod 1 - Using iloc[-1]:")
    print(df.iloc[-1])
    
    # Method 2: Using tail
    print("\nMethod 2 - Using tail(1):")
    print(df.tail(1))
    
    # Method 3: Using index calculation
    print("\nMethod 3 - Using index calculation:")
    last_index = len(df) - 1
    print(df.iloc[last_index])
    
    print("\n" + "=" * 60)
    print("First vs Last record comparison:")
    print("-" * 60)
    
    first_record = df.iloc[0]
    
    comparison_data = {
        'Attribute': ['StudentID', 'Name', 'Age', 'Course', 'Marks'],
        'First Record': [
            first_record['StudentID'],
            first_record['Name'],
            first_record['Age'],
            first_record['Course'],
            first_record['Marks']
        ],
        'Last Record': [
            last_record['StudentID'],
            last_record['Name'],
            last_record['Age'],
            last_record['Course'],
            last_record['Marks']
        ],
        'Difference': [
            last_record['StudentID'] - first_record['StudentID'],
            'N/A',
            last_record['Age'] - first_record['Age'],
            'Same' if first_record['Course'] == last_record['Course'] else 'Different',
            last_record['Marks'] - first_record['Marks']
        ]
    }
    
    comparison_df = pd.DataFrame(comparison_data)
    print(comparison_df)
    
    print("\n" + "=" * 60)
    print("Last few records (context):")
    print("-" * 60)
    
    # Show last 3 records for context
    print("Last 3 records:")
    print(df.tail(3))
    
    print("\n" + "=" * 60)
    print("Statistical summary of last record:")
    print("-" * 60)
    
    # Calculate where last record stands
    marks_mean = df['Marks'].mean()
    marks_median = df['Marks'].median()
    last_marks = last_record['Marks']
    
    print(f"Average marks of all students: {marks_mean:.2f}")
    print(f"Median marks: {marks_median}")
    print(f"Last student's marks: {last_marks}")
    
    if last_marks > marks_mean:
        position = "above average"
    elif last_marks < marks_mean:
        position = "below average"
    else:
        position = "exactly average"
    
    print(f"Last student's marks are {position}")
    
    print("\n" + "=" * 60)
    print("Formatted last record display:")
    print("-" * 60)
    
    print(f"""
    LAST STUDENT RECORD (Record #{total_records})
    =============================================
    Student ID  : {last_record['StudentID']}
    Name        : {last_record['Name']}
    Age         : {last_record['Age']} years
    Course      : {last_record['Course']}
    Grade       : {last_record['Grade']}
    Marks       : {last_record['Marks']}/100
    City        : {last_record['City']}
    
    Position    : Last of {total_records} records
    Marks vs Avg: {last_marks} ({position})
    """)
    
    # Bonus: Get last non-null record if last row has nulls
    print("\n" + "=" * 60)
    print("Handling potential null values in last row:")
    print("-" * 60)
    
    # Create a test with potential nulls
    df_test = df.copy()
    # Simulate null in last row (for demonstration)
    if not df_test.empty:
        df_test.iloc[-1, df_test.columns.get_loc('City')] = None
        print("Simulated null in last row's City column")
        
        # Find last non-null record for each column
        print("\nLast non-null values for each column:")
        for column in df_test.columns:
            last_non_null = df_test[column].dropna().iloc[-1] if not df_test[column].dropna().empty else None
            print(f"  {column:15}: {last_non_null}")
    
except Exception as e:
    print(f"Error: {e}")
    
    # If file doesn't exist, create sample
    if "No such file" in str(e):
        print("\nCreating sample students.xlsx file...")
        import numpy as np
        
        data = {
            'StudentID': range(101, 111),
            'Name': [f'Student {i}' for i in range(1, 11)],
            'Age': np.random.randint(18, 25, 10),
            'Course': np.random.choice(['CS', 'Math', 'Physics', 'Chemistry'], 10),
            'Grade': np.random.choice(['A', 'B+', 'B', 'A-'], 10),
            'Marks': np.random.randint(70, 100, 10),
            'City': np.random.choice(['City A', 'City B', 'City C', 'City D'], 10)
        }
        
        df_sample = pd.DataFrame(data)
        df_sample.to_excel('students.xlsx', index=False)
        print("Sample file created. Run the code again.")</pre>
        </div>

        <div class="question">
            <h3>7. Print records 1st to 7th from Excel</h3>
            <button class="copy-btn" onclick="copyCode('code36')">Copy Code</button>
            <pre id="code36">import pandas as pd

print("Records 1st to 7th from students.xlsx:")
print("=" * 60)

try:
    # Read Excel file
    df = pd.read_excel('students.xlsx')
    
    total_records = len(df)
    print(f"Total records available: {total_records}")
    
    if total_records < 7:
        print(f"Warning: Only {total_records} records available, showing all.")
        records_to_show = total_records
    else:
        records_to_show = 7
    
    # Get records 1 to 7 (0-indexed, so 0:7 gives first 7 records)
    records_1_to_7 = df.iloc[0:records_to_show]
    
    print(f"\nDisplaying records 1 to {records_to_show}:")
    print("-" * 80)
    
    # Display in table format
    pd.set_option('display.max_columns', None)
    pd.set_option('display.width', 1000)
    
    print(records_1_to_7.to_string(index=False))
    
    print("\n" + "=" * 60)
    print("Individual record details:")
    print("-" * 60)
    
    # Display each record separately
    for i in range(records_to_show):
        record = df.iloc[i]
        print(f"\nRecord {i+1}:")
        print(f"  ID: {record['StudentID']}")
        print(f"  Name: {record['Name']}")
        print(f"  Age: {record['Age']}")
        print(f"  Course: {record['Course']}")
        print(f"  Marks: {record['Marks']}")
        print(f"  City: {record['City']}")
    
    print("\n" + "=" * 60)
    print("Statistics for records 1-7:")
    print("-" * 60)
    
    # Calculate statistics for these records
    print(f"Number of records: {len(records_1_to_7)}")
    print(f"Average age: {records_1_to_7['Age'].mean():.1f} years")
    print(f"Average marks: {records_1_to_7['Marks'].mean():.1f}/100")
    print(f"Highest marks: {records_1_to_7['Marks'].max()}")
    print(f"Lowest marks: {records_1_to_7['Marks'].min()}")
    
    # Course distribution
    print("\nCourse distribution in first 7 records:")
    course_counts = records_1_to_7['Course'].value_counts()
    for course, count in course_counts.items():
        print(f"  {course}: {count} student(s)")
    
    print("\n" + "=" * 60)
    print("Alternative slicing methods:")
    print("-" * 60)
    
    # Method 1: Using iloc (already used)
    print("Method 1 - df.iloc[0:7]")
    
    # Method 2: Using head
    print("Method 2 - df.head(7)")
    print(df.head(7))
    
    # Method 3: Using loc with range
    print("\nMethod 3 - df.loc[0:6]")
    print(df.loc[0:6])
    
    print("\n" + "=" * 60)
    print("Exporting these records to CSV:")
    print("-" * 60)
    
    # Export to CSV
    records_1_to_7.to_csv('first_7_records.csv', index=False)
    print("✓ First 7 records exported to 'first_7_records.csv'")
    
    # Verify export
    print("\nVerifying exported file:")
    df_exported = pd.read_csv('first_7_records.csv')
    print(f"Records in exported file: {len(df_exported)}")
    
    print("\n" + "=" * 60)
    print("Comparison: First 7 vs All records:")
    print("-" * 60)
    
    # Compare statistics
    all_avg_marks = df['Marks'].mean()
    first7_avg_marks = records_1_to_7['Marks'].mean()
    
    all_avg_age = df['Age'].mean()
    first7_avg_age = records_1_to_7['Age'].mean()
    
    print(f"{'Metric':<20} {'First 7':<10} {'All':<10} {'Difference':<10}")
    print("-" * 50)
    print(f"{'Avg Marks':<20} {first7_avg_marks:<10.1f} {all_avg_marks:<10.1f} {first7_avg_marks - all_avg_marks:<10.1f}")
    print(f"{'Avg Age':<20} {first7_avg_age:<10.1f} {all_avg_age:<10.1f} {first7_avg_age - all_avg_age:<10.1f}")
    print(f"{'Count':<20} {len(records_1_to_7):<10} {len(df):<10} {len(records_1_to_7) - len(df):<10}")
    
except Exception as e:
    print(f"Error: {e}")
    
    # Create sample file if needed
    if "No such file" in str(e):
        print("\nCreating sample students.xlsx with 10 records...")
        
        data = {
            'StudentID': range(101, 111),
            'Name': ['Alice', 'Bob', 'Charlie', 'Diana', 'Ethan', 
                    'Fiona', 'George', 'Hannah', 'Ian', 'Jessica'],
            'Age': [20, 21, 22, 20, 23, 21, 22, 20, 23, 21],
            'Course': ['CS', 'Math', 'Physics', 'CS', 'Chemistry', 
                      'Math', 'Physics', 'CS', 'Chemistry', 'Math'],
            'Grade': ['A', 'B+', 'A-', 'B', 'A', 'B+', 'A-', 'B', 'A', 'B+'],
            'Marks': [95, 82, 88, 76, 92, 85, 87, 78, 91, 83],
            'City': ['New York', 'London', 'Paris', 'Tokyo', 'Berlin', 
                    'Mumbai', 'Delhi', 'Sydney', 'Toronto', 'Singapore']
        }
        
        df_sample = pd.DataFrame(data)
        df_sample.to_excel('students.xlsx', index=False)
        print("Sample file created with 10 records. Run the code again.")</pre>
        </div>

        <div class="question">
            <h3>8. Print odd numbered records</h3>
            <button class="copy-btn" onclick="copyCode('code37')">Copy Code</button>
            <pre id="code37">import pandas as pd
import numpy as np

print("Odd numbered records from students.xlsx:")
print("=" * 60)

try:
    # Read Excel file
    df = pd.read_excel('students.xlsx')
    
    total_records = len(df)
    print(f"Total records: {total_records}")
    
    # Get odd numbered records (1-based indexing: 1, 3, 5, ...)
    # In 0-based indexing, these are even indices: 0, 2, 4, ...
    odd_records = df.iloc[::2]  # Start at 0, step by 2
    
    print(f"Odd numbered records found: {len(odd_records)}")
    
    print("\nOdd Records (1, 3, 5, ...):")
    print("-" * 80)
    
    # Display with original row numbers
    for i, (index, row) in enumerate(odd_records.iterrows()):
        record_num = index + 1  # Convert to 1-based
        print(f"\nRecord #{record_num} (Original row {index}):")
        print(f"  ID: {row['StudentID']}")
        print(f"  Name: {row['Name']}")
        print(f"  Age: {row['Age']}")
        print(f"  Course: {row['Course']}")
        print(f"  Marks: {row['Marks']}/100")
        print(f"  City: {row['City']}")
    
    print("\n" + "=" * 60)
    print("All odd records in table format:")
    print("-" * 80)
    
    # Reset index to show original row numbers
    odd_records_display = odd_records.copy()
    odd_records_display['Original Row'] = odd_records_display.index + 1
    
    # Reorder columns
    cols = ['Original Row'] + [col for col in odd_records_display.columns if col != 'Original Row']
    odd_records_display = odd_records_display[cols]
    
    print(odd_records_display.to_string(index=False))
    
    print("\n" + "=" * 60)
    print("Statistics for odd records:")
    print("-" * 60)
    
    odd_count = len(odd_records)
    even_count = total_records - odd_count
    
    print(f"Odd records: {odd_count}")
    print(f"Even records: {even_count}")
    print(f"Total: {total_records}")
    
    if odd_count > 0:
        print(f"\nAverage marks (odd records): {odd_records['Marks'].mean():.1f}")
        print(f"Average age (odd records): {odd_records['Age'].mean():.1f}")
        
        # Compare with all records
        all_avg_marks = df['Marks'].mean()
        odd_avg_marks = odd_records['Marks'].mean()
        
        if odd_avg_marks > all_avg_marks:
            comparison = "higher than"
        elif odd_avg_marks < all_avg_marks:
            comparison = "lower than"
        else:
            comparison = "equal to"
        
        print(f"\nOdd records' average marks are {comparison} overall average ({all_avg_marks:.1f})")
    
    print("\n" + "=" * 60)
    print("Alternative methods to get odd records:")
    print("-" * 60)
    
    # Method 1: Using iloc with step (already used)
    print("Method 1: df.iloc[::2]")
    
    # Method 2: Using boolean indexing
    print("\nMethod 2: Boolean indexing")
    odd_indices = [i % 2 == 0 for i in range(len(df))]  # Even indices in 0-based = odd in 1-based
    odd_records_bool = df[odd_indices]
    print(f"Records found: {len(odd_records_bool)}")
    
    # Method 3: Using range
    print("\nMethod 3: Using range with step")
    odd_indices_range = range(0, len(df), 2)
    odd_records_range = df.iloc[list(odd_indices_range)]
    print(f"Records found: {len(odd_records_range)}")
    
    print("\n" + "=" * 60)
    print("Odd vs Even records comparison:")
    print("-" * 60)
    
    # Get even records for comparison
    even_records = df.iloc[1::2]  # Start at 1, step by 2
    
    if len(odd_records) > 0 and len(even_records) > 0:
        comparison_data = {
            'Metric': ['Count', 'Avg Age', 'Avg Marks', 'Max Marks', 'Min Marks'],
            'Odd Records': [
                len(odd_records),
                odd_records['Age'].mean(),
                odd_records['Marks'].mean(),
                odd_records['Marks'].max(),
                odd_records['Marks'].min()
            ],
            'Even Records': [
                len(even_records),
                even_records['Age'].mean(),
                even_records['Marks'].mean(),
                even_records['Marks'].max(),
                even_records['Marks'].min()
            ]
        }
        
        # Format the data
        comparison_df = pd.DataFrame(comparison_data)
        comparison_df['Odd Records'] = comparison_df['Odd Records'].apply(
            lambda x: f"{x:.1f}" if isinstance(x, float) else str(x))
        comparison_df['Even Records'] = comparison_df['Even Records'].apply(
            lambda x: f"{x:.1f}" if isinstance(x, float) else str(x))
        
        print(comparison_df.to_string(index=False))
    
    print("\n" + "=" * 60)
    print("Course distribution comparison:")
    print("-" * 60)
    
    print("\nOdd records courses:")
    print(odd_records['Course'].value_counts())
    
    print("\nEven records courses:")
    print(even_records['Course'].value_counts())
    
    print("\n" + "=" * 60)
    print("Exporting odd records to Excel:")
    print("-" * 60)
    
    # Export to Excel
    odd_records.to_excel('odd_records.xlsx', index=False)
    print("✓ Odd records exported to 'odd_records.xlsx'")
    
    # Also export to CSV
    odd_records.to_csv('odd_records.csv', index=False)
    print("✓ Odd records exported to 'odd_records.csv'")
    
except Exception as e:
    print(f"Error: {e}")
    
    # Create sample data if needed
    if "No such file" in str(e):
        print("\nCreating sample data...")
        
        data = {
            'StudentID': range(101, 111),
            'Name': [f'Student {i}' for i in range(1, 11)],
            'Age': np.random.randint(18, 25, 10),
            'Course': np.random.choice(['CS', 'Math', 'Physics'], 10),
            'Marks': np.random.randint(70, 100, 10),
            'City': np.random.choice(['City A', 'City B', 'City C'], 10)
        }
        
        df_sample = pd.DataFrame(data)
        df_sample.to_excel('students.xlsx', index=False)
        print("Sample file created. Run the code again.")</pre>
        </div>

        <div class="question">
            <h3>9. Print even numbered records</h3>
            <button class="copy-btn" onclick="copyCode('code38')">Copy Code</button>
            <pre id="code38">import pandas as pd
import numpy as np

print("Even numbered records from students.xlsx:")
print("=" * 60)

try:
    # Read Excel file
    df = pd.read_excel('students.xlsx')
    
    total_records = len(df)
    print(f"Total records: {total_records}")
    
    # Get even numbered records (1-based indexing: 2, 4, 6, ...)
    # In 0-based indexing, these are odd indices: 1, 3, 5, ...
    even_records = df.iloc[1::2]  # Start at 1, step by 2
    
    print(f"Even numbered records found: {len(even_records)}")
    
    print("\nEven Records (2, 4, 6, ...):")
    print("-" * 80)
    
    # Display with original row numbers
    for i, (index, row) in enumerate(even_records.iterrows()):
        record_num = index + 1  # Convert to 1-based
        print(f"\nRecord #{record_num} (Original row {index}):")
        print(f"  ID: {row['StudentID']}")
        print(f"  Name: {row['Name']}")
        print(f"  Age: {row['Age']}")
        print(f"  Course: {row['Course']}")
        print(f"  Marks: {row['Marks']}/100")
        print(f"  City: {row['City']}")
    
    print("\n" + "=" * 60)
    print("All even records in table format:")
    print("-" * 80)
    
    # Reset index to show original row numbers
    even_records_display = even_records.copy()
    even_records_display['Original Row'] = even_records_display.index + 1
    
    # Reorder columns
    cols = ['Original Row'] + [col for col in even_records_display.columns if col != 'Original Row']
    even_records_display = even_records_display[cols]
    
    print(even_records_display.to_string(index=False))
    
    print("\n" + "=" * 60)
    print("Statistics for even records:")
    print("-" * 60)
    
    even_count = len(even_records)
    odd_count = total_records - even_count
    
    print(f"Even records: {even_count}")
    print(f"Odd records: {odd_count}")
    print(f"Total: {total_records}")
    
    if even_count > 0:
        print(f"\nAverage marks (even records): {even_records['Marks'].mean():.1f}")
        print(f"Average age (even records): {even_records['Age'].mean():.1f}")
        
        # Compare with all records
        all_avg_marks = df['Marks'].mean()
        even_avg_marks = even_records['Marks'].mean()
        
        if even_avg_marks > all_avg_marks:
            comparison = "higher than"
        elif even_avg_marks < all_avg_marks:
            comparison = "lower than"
        else:
            comparison = "equal to"
        
        print(f"\nEven records' average marks are {comparison} overall average ({all_avg_marks:.1f})")
        
        # Course distribution in even records
        print(f"\nCourse distribution in even records:")
        course_counts = even_records['Course'].value_counts()
        for course, count in course_counts.items():
            percentage = (count / even_count) * 100
            print(f"  {course}: {count} student(s) ({percentage:.1f}%)")
    
    print("\n" + "=" * 60)
    print("Different approaches to get even records:")
    print("-" * 60)
    
    # Approach 1: Using iloc with step (already used)
    print("Approach 1: df.iloc[1::2]")
    
    # Approach 2: Using list comprehension
    print("\nApproach 2: List comprehension")
    even_indices = [i for i in range(len(df)) if i % 2 == 1]
    even_records_list = df.iloc[even_indices]
    print(f"Records found: {len(even_records_list)}")
    
    # Approach 3: Using numpy
    print("\nApproach 3: Using numpy array")
    even_indices_np = np.arange(1, len(df), 2)
    even_records_np = df.iloc[even_indices_np]
    print(f"Records found: {len(even_records_np)}")
    
    print("\n" + "=" * 60)
    print("Performance comparison of different methods:")
    print("-" * 60)
    
    import time
    
    methods = {
        'iloc_step': lambda: df.iloc[1::2],
        'boolean_idx': lambda: df[[i % 2 == 1 for i in range(len(df))]],
        'list_comp': lambda: df.iloc[[i for i in range(len(df)) if i % 2 == 1]],
        'numpy': lambda: df.iloc[np.arange(1, len(df), 2)]
    }
    
    for method_name, method_func in methods.items():
        start_time = time.time()
        result = method_func()
        elapsed = time.time() - start_time
        print(f"{method_name:15}: {len(result)} records, {elapsed:.6f} seconds")
    
    print("\n" + "=" * 60)
    print("Combined analysis of odd and even records:")
    print("-" * 60)
    
    # Get odd records for comparison
    odd_records = df.iloc[::2]
    
    if len(odd_records) > 0 and len(even_records) > 0:
        analysis_data = []
        
        # Numeric columns analysis
        numeric_cols = ['Age', 'Marks']
        
        for col in numeric_cols:
            odd_mean = odd_records[col].mean()
            even_mean = even_records[col].mean()
            all_mean = df[col].mean()
            
            analysis_data.append({
                'Column': col,
                'Odd Mean': f"{odd_mean:.2f}",
                'Even Mean': f"{even_mean:.2f}",
                'All Mean': f"{all_mean:.2f}",
                'Difference': f"{odd_mean - even_mean:.2f}"
            })
        
        # Categorical columns analysis (only if columns exist)
        cat_cols = [col for col in ['Course', 'Grade'] if col in df.columns]
        
        for col in cat_cols:
            odd_mode = odd_records[col].mode()[0] if not odd_records[col].mode().empty else 'N/A'
            even_mode = even_records[col].mode()[0] if not even_records[col].mode().empty else 'N/A'
            
            analysis_data.append({
                'Column': col,
                'Odd Mode': str(odd_mode),
                'Even Mode': str(even_mode),
                'All Mode': df[col].mode()[0] if not df[col].mode().empty else 'N/A',
                'Difference': 'Same' if odd_mode == even_mode else 'Different'
            })
        
        analysis_df = pd.DataFrame(analysis_data)
        print(analysis_df.to_string(index=False))
    
    print("\n" + "=" * 60)
    print("Exporting results:")
    print("-" * 60)
    
    # Export even records
    even_records.to_excel('even_records.xlsx', index=False)
    print("✓ Even records exported to 'even_records.xlsx'")
    
    # Export comparison report
    if 'analysis_df' in locals():
        analysis_df.to_csv('odd_even_comparison.csv', index=False)
        print("✓ Comparison report exported to 'odd_even_comparison.csv'")
    
except Exception as e:
    print(f"Error: {e}")
    
    if "No such file" in str(e):
        print("\nCreating sample students.xlsx file...")
        
        # Create sample data
        np.random.seed(42)  # For reproducibility
        data = {
            'StudentID': range(101, 111),
            'Name': [f'Student {i}' for i in range(1, 11)],
            'Age': np.random.randint(18, 25, 10),
            'Course': np.random.choice(['CS', 'Math', 'Physics', 'Chemistry'], 10),
            'Grade': np.random.choice(['A', 'B+', 'B', 'A-'], 10),
            'Marks': np.random.randint(70, 100, 10),
            'City': np.random.choice(['New York', 'London', 'Paris', 'Tokyo'], 10)
        }
        
        df_sample = pd.DataFrame(data)
        df_sample.to_excel('students.xlsx', index=False)
        print("Sample file created with 10 records. Run the code again.")</pre>
        </div>

    </div>

    <div class="footer">
        <p>Python Practical Solutions - BCA Semester 3</p>
        <p>Complete guide for SQLite3, CSV/Excel operations, and Data Analysis</p>
    </div>

    <script>
        // Tab switching functionality
        function showTab(tabId) {
            // Hide all content
            const contents = document.querySelectorAll('.content');
            contents.forEach(content => {
                content.classList.remove('active');
            });

            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected content
            document.getElementById(tabId).classList.add('active');

            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Copy code functionality
        function copyCode(codeId) {
            const codeElement = document.getElementById(codeId);
            const textArea = document.createElement('textarea');
            textArea.value = codeElement.textContent;
            document.body.appendChild(textArea);
            textArea.select();

            try {
                document.execCommand('copy');
                // Change button text temporarily
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                button.style.background = '#28a745';

                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '#28a745';
                }, 2000);
            } catch (err) {
                console.error('Failed to copy:', err);
                alert('Failed to copy code. Please copy manually.');
            }

            document.body.removeChild(textArea);
        }

        // Smooth scroll to top
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                if (!document.getElementById('scrollTop')) {
                    const scrollBtn = document.createElement('button');
                    scrollBtn.id = 'scrollTop';
                    scrollBtn.innerHTML = '↑';
                    scrollBtn.style.cssText = `
                        position: fixed;
                        bottom: 20px;
                        right: 20px;
                        width: 50px;
                        height: 50px;
                        border-radius: 50%;
                        background: #667eea;
                        color: white;
                        border: none;
                        font-size: 24px;
                        cursor: pointer;
                        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                        z-index: 1000;
                    `;
                    scrollBtn.onclick = () => window.scrollTo({ top: 0, behavior: 'smooth' });
                    document.body.appendChild(scrollBtn);
                }
            } else {
                const scrollBtn = document.getElementById('scrollTop');
                if (scrollBtn) scrollBtn.remove();
            }
        });

        // Print current tab
        function printTab() {
            window.print();
        }

        // Search functionality
        function searchCode() {
            const searchTerm = prompt('Enter search term:');
            if (searchTerm) {
                const found = window.find(searchTerm);
                if (!found) {
                    alert('No results found for: ' + searchTerm);
                }
            }
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            // Ctrl+F for search
            if (e.ctrlKey && e.key === 'f') {
                e.preventDefault();
                searchCode();
            }
            // Ctrl+P for print
            if (e.ctrlKey && e.key === 'p') {
                e.preventDefault();
                printTab();
            }
        });

        // Initialize
        console.log('Python Practical Solutions loaded successfully!');
        console.log('Use Ctrl+F to search, Ctrl+P to print');
    </script>
</body>

</html>